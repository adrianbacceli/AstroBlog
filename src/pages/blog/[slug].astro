---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection('blog', (p) => !p.data.draft);
  return entries
    .filter((e) => !!e.slug)
    .map((entry) => ({
      params: { slug: entry.slug },   // <-- single segment, no split()
      props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content, data } = await entry.render();
---
<BaseLayout title={`${data.title} · Adrian`} description={data.description}>
  <article class="card" style="padding:1.25rem">
    <header style="margin-bottom:1rem">
      <h1 style="margin:0 0 .25rem">{data.title}</h1>
      <div class="meta">
        {new Date(data.pubDate).toISOString().slice(0,10)}
        {data.updated && <> · updated {new Date(data.updated).toISOString().slice(0,10)}</>}
      </div>
    </header>
    <Content />
  </article>
</BaseLayout>
